var app=function(){"use strict";function t(){}function e(t){return t()}function a(){return Object.create(null)}function n(t){t.forEach(e)}function s(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(e,a,n){e.$$.on_destroy.push(function(e,...a){if(null==e)return t;const n=e.subscribe(...a);return n.unsubscribe?()=>n.unsubscribe():n}(a,n))}function l(t,e){t.appendChild(e)}function i(t,e,a){t.insertBefore(e,a||null)}function c(t){t.parentNode.removeChild(t)}function d(t,e){for(let a=0;a<t.length;a+=1)t[a]&&t[a].d(e)}function u(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function p(){return h(" ")}function m(t,e,a,n){return t.addEventListener(e,a,n),()=>t.removeEventListener(e,a,n)}function f(t,e,a){null==a?t.removeAttribute(e):t.getAttribute(e)!==a&&t.setAttribute(e,a)}function g(t,e){(null!=e||t.value)&&(t.value=e)}class _{constructor(t,e=null){this.e=u("div"),this.a=e,this.u(t)}m(t,e=null){for(let a=0;a<this.n.length;a+=1)i(t,this.n[a],e);this.t=t}u(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}p(t){this.d(),this.u(t),this.m(this.t,this.a)}d(){this.n.forEach(c)}}let b;function y(t){b=t}function w(){if(!b)throw new Error("Function called outside component initialization");return b}function v(t){return w().$$.context.get(t)}const $=[],k=[],C=[],S=[],O=Promise.resolve();let R=!1;function E(t){C.push(t)}const x=new Set;function M(){do{for(;$.length;){const t=$.shift();y(t),T(t.$$)}for(;k.length;)k.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];x.has(e)||(x.add(e),e())}C.length=0}while($.length);for(;S.length;)S.pop()();R=!1,x.clear()}function T(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(E)}}const q=new Set;let A;function D(){A={r:0,c:[],p:A}}function z(){A.r||n(A.c),A=A.p}function F(t,e){t&&t.i&&(q.delete(t),t.i(e))}function Y(t,e,a,n){if(t&&t.o){if(q.has(t))return;q.add(t),A.c.push(()=>{q.delete(t),n&&(a&&t.d(1),n())}),t.o(e)}}function W(t,e){Y(t,1,1,()=>{e.delete(t.key)})}function N(t){t&&t.c()}function j(t,a,r){const{fragment:o,on_mount:l,on_destroy:i,after_update:c}=t.$$;o&&o.m(a,r),E(()=>{const a=l.map(e).filter(s);i?i.push(...a):n(a),t.$$.on_mount=[]}),c.forEach(E)}function H(t,e){const a=t.$$;null!==a.fragment&&(n(a.on_destroy),a.fragment&&a.fragment.d(e),a.on_destroy=a.fragment=null,a.ctx=[])}function B(t,e){-1===t.$$.dirty[0]&&($.push(t),R||(R=!0,O.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function I(e,s,r,o,l,i,c=[-1]){const d=b;y(e);const u=s.props||{},h=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:l,bound:a(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:a(),dirty:c};let p=!1;h.ctx=r?r(e,u,(t,a,...n)=>{const s=n.length?n[0]:a;return h.ctx&&l(h.ctx[t],h.ctx[t]=s)&&(h.bound[t]&&h.bound[t](s),p&&B(e,t)),a}):[],h.update(),p=!0,n(h.before_update),h.fragment=!!o&&o(h.ctx),s.target&&(s.hydrate?h.fragment&&h.fragment.l(function(t){return Array.from(t.childNodes)}(s.target)):h.fragment&&h.fragment.c(),s.intro&&F(e.$$.fragment),j(e,s.target,s.anchor),M()),y(d)}class P{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const a=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return a.push(e),()=>{const t=a.indexOf(e);-1!==t&&a.splice(t,1)}}$set(){}}const G=[];function U(e,a=t){let n;const s=[];function o(t){if(r(e,t)&&(e=t,n)){const t=!G.length;for(let t=0;t<s.length;t+=1){const a=s[t];a[1](),G.push(a,e)}if(t){for(let t=0;t<G.length;t+=2)G[t][0](G[t+1]);G.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(r,l=t){const i=[r,l];return s.push(i),1===s.length&&(n=a(o)||t),r(e),()=>{const t=s.indexOf(i);-1!==t&&s.splice(t,1),0===s.length&&(n(),n=null)}}}}const Q=function(){const{subscribe:t,update:e}=U([]);return{subscribe:t,add:t=>e(e=>[...e,t])}}(),V=function(){const{subscribe:t,set:e,update:a}=U({});return{subscribe:t,show:t=>(Z.set(!0),e(t))}}(),Z=U(!1),J=U(null);function X(t,e,a){const n=t.slice();return n[9]=e[a],n}function K(t){let e,a,n,s=t[9]+"";function r(...e){return t[8](t[9],...e)}return{c(){e=u("li"),a=h(s),f(e,"class","svelte-1dvnsjx")},m(t,s){i(t,e,s),l(e,a),n=m(e,"click",r)},p(e,n){t=e,2&n&&s!==(s=t[9]+"")&&function(t,e){e=""+e,t.data!==e&&(t.data=e)}(a,s)},d(t){t&&c(e),n()}}}function tt(e){let a,s,r,o,h,_,b,y,w,v=e[1],$=[];for(let t=0;t<v.length;t+=1)$[t]=K(X(e,v,t));return{c(){a=u("form"),s=u("input"),r=p(),o=u("ul");for(let t=0;t<$.length;t+=1)$[t].c();h=p(),_=u("input"),b=p(),y=u("a"),y.textContent="Reset Map",f(s,"id","address"),f(s,"placeholder","Enter a NYC Address"),f(s,"type","text"),f(s,"name","address"),f(s,"autocomplete","off"),f(s,"class","svelte-1dvnsjx"),f(o,"class","svelte-1dvnsjx"),f(_,"type","submit"),_.value="Search",f(_,"class","svelte-1dvnsjx"),f(y,"href","#"),f(y,"class","reset_map svelte-1dvnsjx"),f(a,"class","svelte-1dvnsjx")},m(t,n){i(t,a,n),l(a,s),g(s,e[0]),l(a,r),l(a,o);for(let t=0;t<$.length;t+=1)$[t].m(o,null);var c;l(a,h),l(a,_),l(a,b),l(a,y),w=[m(s,"input",e[7]),m(s,"keyup",e[3]),m(y,"click",e[4]),m(a,"submit",(c=e[2],function(t){return t.preventDefault(),c.call(this,t)}))]},p(t,[e]){if(1&e&&s.value!==t[0]&&g(s,t[0]),6&e){let a;for(v=t[1],a=0;a<v.length;a+=1){const n=X(t,v,a);$[a]?$[a].p(n,e):($[a]=K(n),$[a].c(),$[a].m(o,null))}for(;a<$.length;a+=1)$[a].d(1);$.length=v.length}},i:t,o:t,d(t){t&&c(a),d($,t),n(w)}}}function et(t,e,a){let n;o(t,J,t=>a(6,n=t));let s,r="",l=[];function i(t){a(0,r=t),a(1,l=[]),fetch(`https://geosearch.planninglabs.nyc/v1/search?text=${r}`).then(t=>t.json()).then(t=>{if(t.features.length){const e=t.features[0].geometry.coordinates.reverse();n.setView(e),s&&s.remove(),s=L.marker(e).addTo(n)}})}return[r,l,i,function(){r.length>1?fetch(`https://geosearch.planninglabs.nyc/v1/search?text=${r}`).then(t=>t.json()).then(t=>a(1,l=t.features.map(t=>t.properties.label.replace(", New York, NY, USA","")).slice(0,5))):a(1,l=[])},function(){s&&s.remove(),n.setView([40.73,-74],17)},s,n,function(){r=this.value,a(0,r)},t=>i(t)]}class at extends P{constructor(t){super(),I(this,t,et,tt,r,{})}}function nt(e){let a;return{c(){a=u("div"),a.innerHTML='<div class="spinner svelte-zrirrj"></div> \n  <p>loading layers..</p>',f(a,"class","loading-box svelte-zrirrj")},m(t,e){i(t,a,e)},p:t,i:t,o:t,d(t){t&&c(a)}}}class st extends P{constructor(t){super(),I(this,t,null,nt,r,{})}}function rt(t,e,a){const n=t.slice();return n[7]=e[a].image,n[8]=e[a].text,n}function ot(e){let a,n,s,r,o,d=e[8]+"";return{c(){a=u("img"),s=p(),r=u("p"),o=h(d),a.src!==(n=e[7])&&f(a,"src",n),f(a,"alt","icon"),f(a,"class","icon svelte-16k34q6")},m(t,e){i(t,a,e),i(t,s,e),i(t,r,e),l(r,o)},p:t,d(t){t&&c(a),t&&c(s),t&&c(r)}}}function lt(e){let a,n,s,r,o,h,g,_,b,y,w,v=e[2]&&function(e){let a;return{c(){a=u("em"),a.textContent=`${e[2]}`,f(a,"class","svelte-16k34q6")},m(t,e){i(t,a,e)},p:t,d(t){t&&c(a)}}}(e),$=e[3].length&&function(t){let e,a=t[3],n=[];for(let e=0;e<a.length;e+=1)n[e]=ot(rt(t,a,e));return{c(){e=u("div");for(let t=0;t<n.length;t+=1)n[t].c();f(e,"class","legend svelte-16k34q6")},m(t,a){i(t,e,a);for(let t=0;t<n.length;t+=1)n[t].m(e,null)},p(t,s){if(8&s){let r;for(a=t[3],r=0;r<a.length;r+=1){const o=rt(t,a,r);n[r]?n[r].p(o,s):(n[r]=ot(o),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=a.length}},d(t){t&&c(e),d(n,t)}}}(e);return{c(){a=u("div"),n=u("div"),s=u("label"),r=u("input"),o=p(),h=u("span"),g=p(),_=u("span"),_.textContent=`${e[1]}`,b=p(),v&&v.c(),y=p(),$&&$.c(),f(r,"type","checkbox"),f(r,"class","svelte-16k34q6"),f(h,"class","slider svelte-16k34q6"),f(s,"class","switch svelte-16k34q6"),f(_,"class","name svelte-16k34q6"),f(n,"class","input svelte-16k34q6"),f(a,"class","switch-box")},m(t,c){i(t,a,c),l(a,n),l(n,s),l(s,r),r.checked=e[0],l(s,o),l(s,h),l(n,g),l(n,_),l(a,b),v&&v.m(a,null),l(a,y),$&&$.m(a,null),w=m(r,"change",e[6])},p(t,[e]){1&e&&(r.checked=t[0]),t[2]&&v.p(t,e),t[3].length&&$.p(t,e)},i:t,o:t,d(t){t&&c(a),v&&v.d(),$&&$.d(),w()}}}function it(t,e,a){let{layer:n}=e,{label:s,checked:r,notes:o,ref:l}=n,i="legend"in n?n.legend:[];return t.$set=t=>{"layer"in t&&a(4,n=t.layer)},t.$$.update=()=>{1&t.$$.dirty&&(r?l.show():l.hide())},[r,s,o,i,n,l,function(){r=this.checked,a(0,r)}]}class ct extends P{constructor(t){super(),I(this,t,it,lt,r,{layer:4})}}function dt(t,e,a){const n=t.slice();return n[2]=e[a],n}function ut(t){let e;const a=new st({});return{c(){N(a.$$.fragment)},m(t,n){j(a,t,n),e=!0},i(t){e||(F(a.$$.fragment,t),e=!0)},o(t){Y(a.$$.fragment,t),e=!1},d(t){H(a,t)}}}function ht(t,e){let a,n;const s=new ct({props:{layer:e[2]}});return{key:t,first:null,c(){a=h(""),N(s.$$.fragment),this.first=a},m(t,e){i(t,a,e),j(s,t,e),n=!0},p(t,e){const a={};1&e&&(a.layer=t[2]),s.$set(a)},i(t){n||(F(s.$$.fragment,t),n=!0)},o(t){Y(s.$$.fragment,t),n=!1},d(t){t&&c(a),H(s,t)}}}function pt(t){let e,a,n,s,r,o,d,h,m,g,_,b,y,w,v,$,k,C,S,O,R,L,E,x,M=[],T=new Map,q=0===t[0].length&&ut(),A=t[0];const B=t=>t[2].order;for(let e=0;e<A.length;e+=1){let a=dt(t,A,e),n=B(a);T.set(n,M[e]=ht(n,a))}const I=new at({});return{c(){e=u("div"),a=u("h2"),a.textContent="SLA Mapper (SLAM)",n=p(),s=u("div"),s.innerHTML='<h5 class="lighter svelte-1yfhk4t">\n      Tool that aggregates data that community boards often have to gather in\n      order to review liquor license applications and sidewalk café\n      applications. Displaying this information in a unified view saves\n      community boards considerable time and resources.\n    </h5>',r=p(),o=u("div"),d=p(),h=u("h4"),h.textContent="Instructions",m=p(),g=u("h5"),g.textContent="Click on a map feature to learn more about an establishment's liquor\n    license, sidewalk café license, restaurant health grades, or 311 complaints.",_=p(),b=u("div"),y=p(),q&&q.c(),w=p();for(let t=0;t<M.length;t+=1)M[t].c();v=p(),$=u("div"),k=p(),C=u("h4"),C.textContent="Search",S=p(),N(I.$$.fragment),O=p(),R=u("div"),L=p(),E=u("footer"),E.innerHTML='<figure><img class="logo svelte-1yfhk4t" alt="BetaNYC Logo" src="images/BetaNYC_short_white_on_blue.png"> \n      <figcaption class="logo_caption svelte-1yfhk4t">A BetaNYC Tool</figcaption></figure> \n    <div class="footer-links svelte-1yfhk4t"><a href="https://github.com/BetaNYC/SLAM/blob/master/LICENSE">GNU General Public License</a> \n      <span> | </span> \n      <a href="https://github.com/BetaNYC/SLAM/issues">File a GitHub issue</a></div>',f(a,"class","svelte-1yfhk4t"),f(s,"class","about svelte-1yfhk4t"),f(o,"class","separator svelte-1yfhk4t"),f(h,"class","svelte-1yfhk4t"),f(g,"class","lighter svelte-1yfhk4t"),f(b,"class","separator svelte-1yfhk4t"),f($,"class","separator svelte-1yfhk4t"),f(C,"class","svelte-1yfhk4t"),f(R,"class","separator svelte-1yfhk4t"),f(e,"class","toolbox svelte-1yfhk4t")},m(t,c){i(t,e,c),l(e,a),l(e,n),l(e,s),l(e,r),l(e,o),l(e,d),l(e,h),l(e,m),l(e,g),l(e,_),l(e,b),l(e,y),q&&q.m(e,null),l(e,w);for(let t=0;t<M.length;t+=1)M[t].m(e,null);l(e,v),l(e,$),l(e,k),l(e,C),l(e,S),j(I,e,null),l(e,O),l(e,R),l(e,L),l(e,E),x=!0},p(t,[a]){0===t[0].length?q?F(q,1):(q=ut(),q.c(),F(q,1),q.m(e,w)):q&&(D(),Y(q,1,1,()=>{q=null}),z());const n=t[0];D(),M=function(t,e,a,n,s,r,o,l,i,c,d,u){let h=t.length,p=r.length,m=h;const f={};for(;m--;)f[t[m].key]=m;const g=[],_=new Map,b=new Map;for(m=p;m--;){const t=u(s,r,m),l=a(t);let i=o.get(l);i?n&&i.p(t,e):(i=c(l,t),i.c()),_.set(l,g[m]=i),l in f&&b.set(l,Math.abs(m-f[l]))}const y=new Set,w=new Set;function v(t){F(t,1),t.m(l,d),o.set(t.key,t),d=t.first,p--}for(;h&&p;){const e=g[p-1],a=t[h-1],n=e.key,s=a.key;e===a?(d=e.first,h--,p--):_.has(s)?!o.has(n)||y.has(n)?v(e):w.has(s)?h--:b.get(n)>b.get(s)?(w.add(n),v(e)):(y.add(s),h--):(i(a,o),h--)}for(;h--;){const e=t[h];_.has(e.key)||i(e,o)}for(;p;)v(g[p-1]);return g}(M,a,B,1,t,n,T,e,W,ht,v,dt),z()},i(t){if(!x){F(q);for(let t=0;t<A.length;t+=1)F(M[t]);F(I.$$.fragment,t),x=!0}},o(t){Y(q);for(let t=0;t<M.length;t+=1)Y(M[t]);Y(I.$$.fragment,t),x=!1},d(t){t&&c(e),q&&q.d();for(let t=0;t<M.length;t+=1)M[t].d();H(I)}}}function mt(t,e,a){let n,s;return o(t,Q,t=>a(1,n=t)),t.$$.update=()=>{2&t.$$.dirty&&a(0,s=n.sort((t,e)=>t.order-e.order))},[s]}class ft extends P{constructor(t){super(),I(this,t,mt,pt,r,{})}}const gt="0cdd88f5e816766aec13f416ec14b633e6ecb4b6";function _t(t){const{getMap:e,getCartoClient:a,getPopup:n}=v(gt),s=e(),r=a(),o=n(),l=new carto.source.SQL("\n\t\tWITH\n\t\t\tg AS (\n\t\t\t\tSELECT cartodb_id, ST_Transform(ST_GeomFromText(georeference, 4326),3857) AS the_geom_webmercator\n\t\t\t\tFROM liquor_authority_quarterly_list_of_active_licenses WHERE georeference != '' AND zone = 1 AND license_type_code in ('OP','SW','SB','SL','VL','RL','HL','CL','CT','EL','TL','CR','RW','HW','CW','TW','WC','EB','MR')\n\t\t\t),\n\t\t\tm AS (\n\t\t\t\tSELECT array_agg(cartodb_id) AS id_list, the_geom_webmercator, ST_Y(the_geom_webmercator) AS y\n\t\t\t\tFROM g\n\t\t\t\tGROUP BY the_geom_webmercator\n\t\t\t\tORDER BY y DESC\n\t\t\t),\n\t\t\tf AS (\n\t\t\t\tSELECT generate_series(1, array_length(id_list,1)) AS p, unnest(id_list) AS cartodb_id, the_geom_webmercator\n\t\t\t\tFROM m\n\t\t\t)\n      SELECT ST_Translate(f.the_geom_webmercator,0,f.p*5) AS the_geom_webmercator, q.cartodb_id, premise_name, dba, license_type_code, license_issued_date, license_expiration_date, serial_number, certificate_number, premise_address, premise_zip,\n        method_of_operation, days_hours_of_operation,\n\t\t\t\tEXTRACT(year from to_date(license_expiration_date, 'MM/DD/YYYY')) AS expiration_year\n\t\t\t\tFROM f, liquor_authority_quarterly_list_of_active_licenses q\n\t\t\t\tWHERE f.cartodb_id = q.cartodb_id\t\t\n        "),i=new carto.style.CartoCSS("\n        #layer {\n            marker-width: 20;\n            marker-fill-opacity: 0.9;\n            marker-file: url('https://s3.amazonaws.com/com.cartodb.users-assets.production/maki-icons/bar-18.svg');\n            marker-allow-overlap: true;\n            marker-line-width: 1;\n            marker-line-color: #ffffff;\n            marker-line-opacity: 1;\n        }\n        #layer [expiration_year <=2020] {\n            marker-fill: #e10012;\n        }\n        #layer [expiration_year > 2020] {\n            marker-fill: #e34dee;\n        }\n        #layer [zoom > 16] {\n            marker-width: 20;\n        }\n        #layer [zoom <=16] {\n            marker-width: 15;\n        }\n        #layer [zoom <=15] {\n            marker-width: 13;\n        }\n        #layer [zoom <=14] {\n            marker-width: 8;\n        }\n        #layer [zoom <=12] {\n            marker-width: 4;\n        }\n    "),c=new carto.layer.Layer(l,i,{featureClickColumns:["premise_name","dba","serial_number","license_type_code","license_issued_date","license_expiration_date","certificate_number","premise_address","premise_zip","method_of_operation","days_hours_of_operation"]});return r.addLayer(c).then(()=>{Q.add({order:1,ref:c,label:"State Liquor Authority Licenses",legend:[{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629205705bar-15.svg",text:"Expiring before 2020"},{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629205836bar-15.svg",text:"Expiring after 2020"}],checked:!0})}).catch(t=>console.log(t.message)),c.on("featureOver",t=>{let e="";e+='<div class="widget">',e+=`<p class = "bold">${t.data.premise_address}</p><p>${t.data.dba}</p><p>${t.data.premise_name}</p>`,o.setContent(e),o.setLatLng(t.latLng),o.isOpen()||o.openOn(s)}),c.on("featureClicked",t=>{let e="",a="";""!=t.data.doing_business_as_dba?e+=`<h3 class = "bold">${t.data.dba}</h3><h4 class = "bold">${t.data.premise_name}</h4>`:e+=`<h3 class = "bold">${t.data.premise_name}</h3>`,e+=`<h4>${t.data.premise_address}</h4><div class="separator"></div>\n\t\t\t\t<h5 class = "lighter">License Type: ${t.data.license_type_code}</h5>\n\t\t\t\t<h5 class = "lighter">Serial number: ${t.data.serial_number}</h5>\n\t\t\t\t<h5 class = "lighter">Effective Date: ${t.data.license_issued_date}</h5>\n        <h5 class = "lighter">Expiration Date: ${t.data.license_expiration_date}</h5>\n        <h5 class = "lighter">Method of Operation: ${t.data.method_of_operation}</h5>\n        <h5 class = "lighter">Days/Hours of Operation: ${t.data.days_hours_of_operation}</h5>\n\t\t\t\t<h5 class = "lighter"><a href= 'https://www.tran.sla.ny.gov/servlet/ApplicationServlet?pageName=com.ibm.nysla.data.publicquery.PublicQuerySuccessfulResultsPage&validated=true&serialNumber=${t.data.serial_number}&licenseType=${t.data.license_type_code}' target = '_blank'>Click here for more information about this license.</a></h5>`;var n=`https://api.cityofnewyork.us/geoclient/v1/search.json?input=${t.data.premise_address} ${t.data.premise_zip}&app_id=dd37f663&app_key=c99663c5e8b11315279f8d28ef245dab`;new Promise((function(t){fetch("https://cors-anywhere.herokuapp.com/"+n).then((function(t){return t.json()})).then((function(e){const a=e.results[0].response;console.log(a),t(a.buildingIdentificationNumber)})).catch((function(e){t(0)}))})).then(t=>{if(0==t)e+='<div class="separator"></div><h4>Certificate of Occupancy</h4>><h5 class = "lighter">No BIN Found.</h5>';else{e+=`<div class="separator"></div><h4>Certificate of Occupancy</h4><h5 class = "lighter">BIN: <a href= '${`http://a810-bisweb.nyc.gov/bisweb/COsByLocationServlet?requestid=1&allbin=${t}`}' target = '_blank'>${t}</a></h5>`}a+="<div class=\"separator\"></div><h6>Source: <a href='https://data.ny.gov/Economic-Development/Liquor-Authority-Quarterly-List-of-Active-Licenses/hrvs-fxs2'>Liquor Authority Quarterly List of Active Licenses.</a></h6><h6>Data is filtered to liquor licenses reviewed by the New York City Agency Office. Data is updated quarterly.</h6>",V.show({content:e,source:a,charts:[]})})}),r.getLeafletLayer().addTo(s),[]}class bt extends P{constructor(t){super(),I(this,t,_t,null,r,{})}}function yt(t){const{getMap:e,getCartoClient:a,getPopup:n}=v(gt),s=e(),r=a(),o=n(),l=new carto.source.SQL("\n          SELECT * FROM sidewalk_caf_licenses_and_applications\n  "),i=new carto.style.CartoCSS("\n  \t\t\t\t#layer {\n  \t\t\t\tmarker-width: 18;\n  \t\t\t\tmarker-fill-opacity: 0.9;\n  \t\t\t\tmarker-file: url('https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180612173650picnic-site-15.svg');\n  \t\t\t\tmarker-allow-overlap: true;\n  \t\t\t\tmarker-line-width: 0.25;\n  \t\t\t\tmarker-line-color: #FFFFFF;\n  \t\t\t\tmarker-line-opacity: 1;\n  \t\t\t\t}\n  \t\t\t\t#layer [zoom > 16]{\n  \t\t\t\t\tmarker-width: 20;\n  \t\t\t\t}\n  \t\t\t\t#layer [zoom <= 16]{\n  \t\t\t\tmarker-width: 15;\n  \t\t\t\t}\n  \t\t\t\t#layer [zoom <= 15]{\n  \t\t\t\tmarker-width: 13;\n  \t\t\t\t}\n  \t\t\t\t#layer [zoom <= 14]{\n  \t\t\t\tmarker-width: 8;\n  \t\t\t\t}\n  \t\t\t\t#layer [zoom <= 12]{\n  \t\t\t\tmarker-width: 4;\n  \t\t\t\t}\n  \t\t\t\t\t#layer [lic_status = 'Active']{\n  \t\t\t\tmarker-fill: #07d91c;\n  \t\t\t\t\t}\n  \t\t\t\t\t#layer [lic_status = 'Inactive']{\n  \t\t\t\tmarker-fill: #227527;\n  \t\t\t\t\t}\n  \t\t\t\t"),c=new carto.layer.Layer(l,i,{featureOverColumns:["license_nbr","lic_status","business_name","business_name2","building","street","swc_type","swc_sq_ft","swc_tables","swc_chairs","community_district","expiration_date","issuance","issuance_dd","cb","cb_dd","app_id","app_swc_type","app_sq_ft","app_tables","app_chairs","intake_dd"]});return r.addLayer(c).then(()=>{Q.add({order:2,ref:c,label:"Sidewalk Café Licenses",legend:[{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629210223picnic-site-15.svg",text:"Active"},{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629210143picnic-site-15.svg",text:" Inactive"}],checked:!0})}).catch(t=>console.log(t.message)),c.on("featureOver",t=>{let e="";e+='<div class="widget">',e+=`<p class = "bold">${t.data.building} ${t.data.street}</p><p>${t.data.business_name2}</p><p>${t.data.business_name}</p>`,o.setContent(e),o.setLatLng(t.latLng),o.isOpen()||o.openOn(s)}),c.on("featureClicked",t=>{let e="",a="",n=!1,s=!1;"Pending Review"==t.data.issuance&&"Inactive"==t.data.lic_status?(n=!0,s=!1):"Issued"==t.data.issuance&&"Inactive"==t.data.lic_status&&(n=!1,s=!0),e+=`<h3 class = "bold">${t.data.business_name2}</h3>\n\t\t\t\t<h4 class = "bold">${t.data.business_name}</h4>\n\t\t\t\t<h4>${t.data.building} ${t.data.street}</h4><div class="separator"></div>`,e+=1==n?`<h5 class = "lighter">${t.data.issuance}</h5>\n\t\t\t\t\t <h5 class = "lighter">Application ID: ${t.data.app_id}</h5>\n\t\t\t\t\t <h5 class = "lighter">Application Type: ${t.data.app_swc_type}</h5>\n\t\t\t\t\t <h5 class = "lighter">Application Square footage: ${t.data.app_sq_ft}</h5>\n\t\t\t\t\t <h5 class = "lighter">Application Tables: ${t.data.app_tables}</h5>\n\t\t\t\t\t <h5 class = "lighter">Application Chairs: ${t.data.app_chairs}</h5>\n\t\t\t\t\t <h5 class = "lighter">Application Intake Date: ${t.data.intake_dd}</h5>\n\t\t\t\t\t <h5><a href="https://www1.nyc.gov/assets/dca/SidewalkCafeMap/index.html#home" target="_blank">Click here for more information about this sidewalk cafe.</h5>`:1==s?`<h5 class = "lighter">Status: ${t.data.lic_status}</h5>\n\t\t\t\t\t <h5 class = "lighter">License Number: ${t.data.license_nbr}</h5>\n\t\t\t\t\t <h5 class = "lighter">Issuance Date: ${t.data.issuance_dd}</h5>\n\t\t\t\t\t <h5 class = "lighter">Expiration Date: ${t.data.expiration_date}</h5>`:`<h5 class = "lighter">Status: ${t.data.lic_status}</h5>\n\t\t\t\t\t <h5 class = "lighter">License Number: ${t.data.license_nbr}</h5>\n\t\t\t\t\t <h5 class = "lighter">Type: ${t.data.swc_type}</h5>\n\t\t\t\t\t <h5 class = "lighter">Square footage: ${t.data.swc_sq_ft}</h5>\n\t\t\t\t\t <h5 class = "lighter">Tables: ${t.data.swc_tables}</h5>\n\t\t\t\t\t <h5 class = "lighter">Chairs: ${t.data.swc_chairs}</h5>\n\t\t\t\t\t <h5 class = "lighter">Issuance Date: ${t.data.issuance_dd}</h5>\n\t\t\t\t\t <h5 class = "lighter">Expiration Date: ${t.data.expiration_date}</h5>\n\t\t\t\t\t <div class="separator"></div>\n\t\t\t\t\t <h5 class = "lighter">Community Board: ${t.data.community_district}</h5>\n\t\t\t\t\t <h5 class = "lighter">Community Board Review Status: ${t.data.cb}</h5>\n\t\t\t\t\t <h5 class = "lighter">Community Board Review Status Date: ${t.data.cb_dd}</h5>\n\t\t\t\t\t <h5><a href="https://www1.nyc.gov/assets/dca/SidewalkCafeMap/index.html#home" target="_blank">Click here for more information about this sidewalk cafe.</h5>\n\t\t\t\t\t `,a+="<div class=\"separator\"></div><h6>Source: <a href='https://data.cityofnewyork.us/Business/Sidewalk-Caf-Licenses-and-Applications/qcdj-rwhu/data'>Sidewalk Cafe Licenses and Applications.</a></h6><h6>Data is updated weekly.</h6>",V.show({content:e,source:"<div class=\"separator\"></div><h6>Source: <a href='https://data.cityofnewyork.us/Business/Sidewalk-Caf-Licenses-and-Applications/qcdj-rwhu/data'>Sidewalk Cafe Licenses and Applications.</a></h6><h6>Data is updated weekly.</h6>",charts:[]})}),r.getLeafletLayer().addTo(s),[]}class wt extends P{constructor(t){super(),I(this,t,yt,null,r,{})}}const vt={afterDatasetsDraw:function(t){var e=t.ctx;t.data.datasets.forEach((function(a,n){var s=t.getDatasetMeta(n);s.hidden||s.data.forEach((function(t,n){e.fillStyle="rgb(100, 100, 100)";e.font=Chart.helpers.fontString(10,"normal","Helvetica Neue");let s=0;null!=a.data[n]&&(s=a.data[n]);var r=s.toString();e.textAlign="center",e.textBaseline="middle";var o=t.tooltipPosition();0!=r&&e.fillText(r,o.x,o.y-5- -15)}))}))}};function $t(t){const{getMap:e,getCartoClient:a,getPopup:n}=v(gt),s=e(),r=a(),o=n(),l=new carto.source.SQL("WITH\n        s AS (\n            SELECT ROW_NUMBER() OVER(ORDER BY to_timestamp(created_date, 'MM/DD/YYYY') ASC) rownum, the_geom_webmercator, cartodb_id\n            FROM club_bar_restaurant_complaints_since_jan_1_2017),\n        m AS (\n            SELECT array_agg(cartodb_id ORDER BY rownum) id_list, the_geom_webmercator, ST_Y(the_geom_webmercator) y\n            FROM s\n            GROUP BY the_geom_webmercator\n            ORDER BY y DESC),\n        f AS (\n            SELECT  generate_series(1, array_length(id_list,1)) p, unnest(id_list) cartodb_id, the_geom_webmercator\n            FROM m)\n        SELECT  ST_Translate(f.the_geom_webmercator,0,f.p*3) the_geom_webmercator, f.cartodb_id, q.complaint_type, q.descriptor, q.created_date, q.incident_address, q.intersection_street_1, q.intersection_street_2, q.location geometry\n            FROM f, club_bar_restaurant_complaints_since_jan_1_2017 q\n            WHERE f.cartodb_id = q.cartodb_id\n    "),i=new carto.style.CartoCSS('\n  \t\t#layer {\n  \t\t\tmarker-fill: #4d88ee;\n  \t\t\tmarker-fill-opacity: 0.9;\n  \t\t\tmarker-allow-overlap: true;\n  \t\t\tmarker-line-width: 0.25;\n  \t\t\tmarker-line-color: #FFFFFF;\n  \t\t\tmarker-line-opacity: 1;\n  \t\t}\n  \t\t#layer[complaint_type="Drinking"] {\n  \t\t\tmarker-fill: #3622b9;\n  \t\t}\n  \t\t#layer[complaint_type="Noise - Commercial"] {\n  \t\t\tmarker-fill: #4d88ee;\n  \t\t}\n  \t\t#layer [zoom > 16]{\n  \t\t\tmarker-width: 7;\n  \t\t}\n  \t\t#layer [zoom <= 16]{\n  \t\tmarker-width: 5;\n  \t\t}\n  \t\t#layer [zoom <= 15]{\n  \t\tmarker-width: 4;\n  \t\t}\n  \t\t#layer [zoom <= 14]{\n  \t\tmarker-width: 3;\n  \t\t}\n  \t\t#layer [zoom <= 12]{\n  \t\tmarker-width: 2;\n  \t\t}\n\n            '),c=new carto.layer.Layer(l,i,{featureOverColumns:["geometry","incident_address","intersection_street_1","intersection_street_2","created_date","descriptor","complaint_type"]});return r.addLayer(c).then(()=>{Q.add({order:3,ref:c,label:"311 Complaints Since 2017",notes:"*Filtered to those made at club/bar/restaurant",legend:[{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629210011circle-11.svg",text:"Noise"},{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629210053circle-11.svg",text:"Drinking"}],checked:!0})}).catch(t=>console.log(t.message)),c.on("featureOver",t=>{let e="";e+='<div class="widget">',""!=t.data.incident_address?e+=`<p class = "bold">${t.data.incident_address}</p>`:e+=`<p class = "bold">${t.data.intersection_street_1}, ${t.data.intersection_street_2}</p>`,e+=`<p>Complaint Type: ${t.data.complaint_type}</p><p>Descriptor: ${t.data.descriptor}</p><p>Date: ${t.data.created_date}</p>`,o.setContent(e),o.setLatLng(t.latLng),o.isOpen()||o.openOn(s)}),c.on("featureClicked",t=>{let e,a,n="",s="",r={},o=[],l=[],i=[],c={},d=[],u=[],h=[];const p=`https://betanyc.carto.com/api/v2/sql/?q=SELECT cartodb_id, descriptor, created_date, EXTRACT(year from to_date(created_date, 'MM/DD/YYYY')) AS created_year FROM club_bar_restaurant_complaints_since_jan_1_2017 WHERE location='${t.data.geometry}'&api_key=${gt}`;let m=0;fetch(p).then((function(t){return t.json()})).then((function(p){m=p.rows.length,""!=t.data.incident_address?n+=`<h4 class = "bold">${t.data.incident_address}</h4>`:n+=`<h4 class = "bold">${t.data.intersection_street_1}, ${t.data.intersection_street_2}</h4>`,n+=`<div class="separator"></div><h5 class = "lighter">Total Number of Complaints: ${m}</h5>`;for(var f=0;f<m;f++)r[p.rows[f].descriptor]=1+(r[p.rows[f].descriptor]||0);o=Object.keys(r),l=Object.values(r);for(f=0;f<o.length;f++)i.push("#"+(Math.random().toString(16)+"0000000").slice(2,8));const g=document.createElement("canvas"),_=g.getContext("2d");e=new Chart(_,{type:"pie",data:{labels:o,datasets:[{backgroundColor:i,data:l}]},options:{title:{display:!0,text:"Complaints by Descriptor"},legend:{display:!0,labels:{fontSize:10},position:"right",onClick:null,fullWidth:!0}}});for(f=0;f<m;f++)c[p.rows[f].created_year]=1+(c[p.rows[f].created_year]||0);d=Object.keys(c),u=Object.values(c);for(f=0;f<d.length;f++)h.push("#"+(Math.random().toString(16)+"0000000").slice(2,8));const b=document.createElement("canvas"),y=b.getContext("2d");a=new Chart(y,{type:"line",plugins:vt,data:{labels:d,datasets:[{borderColor:"#4d88ee",data:u}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0,fontSize:10},display:!0,scaleLabel:{display:!0,labelString:"# of Complaints",fontSize:10}}],xAxes:[{ticks:{fontSize:10},display:!0,scaleLabel:{display:!0,labelString:"Year",fontSize:10}}]},title:{display:!0,text:"Complaints by Year"}}}),s+="<div class=\"separator\"></div><h6>Source: <a href='https://data.cityofnewyork.us/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9/data'>311 Service Requests from 2010 to Present</a></h6><h6>Data was filtered to complaints at a club/restaurant/bar made since January 1, 2017. Data is updated daily.</h6>",V.show({content:n,source:s,charts:[g,b]})}))}),r.getLeafletLayer().addTo(s),[]}class kt extends P{constructor(t){super(),I(this,t,$t,null,r,{})}}function Ct(t){const{getMap:e,getCartoClient:a,getPopup:n}=v(gt),s=e(),r=a(),o=n(),l=new carto.source.SQL("WITH\n  \t\tm AS (\n  \t\t\tSELECT array_agg(cartodb_id) id_list, the_geom_webmercator, ST_Y(the_geom_webmercator) y\n  \t\t\tFROM dohmh_inspections\n  \t\t\tGROUP BY the_geom_webmercator\n  \t\t\tORDER BY y DESC),\n  \t\tf AS (\n  \t\t\tSELECT  generate_series(1, array_length(id_list,1)) p, unnest(id_list) cartodb_id, the_geom_webmercator\n  \t\t\tFROM m)\n  \t\tSELECT  ST_Translate(f.the_geom_webmercator,0,f.p*5) the_geom_webmercator, f.cartodb_id, q.camis, q.dba, q.building, q.street\n  \t\t\tFROM f, dohmh_inspections q\n  \t\t\tWHERE f.cartodb_id = q.cartodb_id\n            "),i=new carto.style.CartoCSS("\n  \t\t#layer{\n  \t\tmarker-fill: #ff8300;\n  \t\tmarker-fill-opacity: 0.9;\n  \t\tmarker-file: url('https://s3.amazonaws.com/com.cartodb.users-assets.production/maki-icons/embassy-18.svg');\n  \t\tmarker-allow-overlap: true;\n  \t\tmarker-line-width: 1;\n  \t\tmarker-line-color: #FFFFFF;\n  \t\tmarker-line-opacity: 1;\n  \t\t}\n  \t\t#layer [zoom > 16]{\n  \t\t\tmarker-width: 20;\n  \t\t}\n  \t\t#layer [zoom <= 16]{\n  \t\tmarker-width: 15;\n  \t\t}\n  \t\t#layer [zoom <= 15]{\n  \t\tmarker-width: 13;\n  \t\t}\n  \t\t#layer [zoom <= 14]{\n  \t\tmarker-width: 8;\n  \t\t}\n  \t\t#layer [zoom <= 12]{\n  \t\tmarker-width: 4;\n  \t\t}\n\n                "),c=new carto.layer.Layer(l,i,{featureOverColumns:["camis","dba","building","street"]});return r.addLayer(c).then(()=>{Q.add({order:4,ref:c,label:"Restaurant Health Grades",legend:[{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629205921embassy-15.svg",text:"Restaurant"}],checked:!0})}).catch(t=>console.log(t.message)),c.on("featureOver",t=>{let e="";e+='<div class="widget">',e+=`<p class = "bold">${t.data.building} ${t.data.street}</p><p>${t.data.dba}</p>`,o.setContent(e),o.setLatLng(t.latLng),o.isOpen()||o.openOn(s)}),c.on("featureClicked",t=>{let e="",a="";e+=`<h3 class = "bold">${t.data.dba}</h3><h4>${t.data.building} ${t.data.street}</h4><div class="separator"></div>`;var n=`https://betanyc.carto.com/api/v2/sql/?q=SELECT * FROM dohmh_new_york_city_restaurant_inspection_results WHERE camis='${t.data.camis}' ORDER BY to_timestamp(grade_date, 'MM/DD/YYYY') DESC&api_key=${gt}`;fetch(n).then((function(t){return t.json()})).then((function(t){0!=t.rows.length&&(e+=`\n\t\t\t\t\t\t<h5 class = "lighter">Most Recent Grade: ${t.rows[0].grade}</h5>\n\t\t\t\t\t\t<h5 class = "lighter">Grade Date: ${t.rows[0].grade_date}</h5>`),Array.prototype.groupBy=function(t){return this.reduce((function(e,a){const n=a[t];return e[n]=e[n]||[],e[n].push(a),e}),{})};var n=t.rows.groupBy("grade_date");e+='<div class="separator"></div><h5 class = "bold">Grade History</h5>';for(var s=0;s<Object.keys(n).length;s++){var r=Object.keys(n)[s],o=Object.values(n)[s];""!=r&&(e+=`<h5 class = "lighter"> ${r}: ${o[0].grade}</h5>`)}e+='<h5><a href="http://a816-restaurantinspection.nyc.gov/RestaurantInspection/SearchBrowse.do" target="_blank">Click here for more information about this restaurant.</h5> ',a+="<div class=\"separator\"></div><h6>Source: <a href='https://data.cityofnewyork.us/Health/DOHMH-New-York-City-Restaurant-Inspection-Results/43nn-pn8j/data'>DOHMH New York City Restaurant Inspection Results.</a></h6><h6>Data is geocoded with the Department of City Plannings GeoSupport application once a week. The map does not display restaurants with addresses rejected by the application. Data is updated weekly.</h6>",V.show({content:e,source:a,charts:[]})}))}),r.getLeafletLayer().addTo(s),[]}class St extends P{constructor(t){super(),I(this,t,Ct,null,r,{})}}function Ot(t){const{getMap:e,getCartoClient:a,getPopup:n}=v(gt),s=e(),r=a(),o=n(),l=new carto.source.SQL("SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM bkmappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9' UNION SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM bxmappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9' UNION SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM mnmappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9' UNION SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM simappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9' UNION SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM qnmappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9'\n            "),i=new carto.style.CartoCSS("\n\t\t\t\t\t#layer{\n\t\t\t\t\t\tpolygon-fill: #12eda4;\n\t\t\t\t\t}\n\t\t\t\t"),c=new carto.layer.Layer(l,i,{featureOverColumns:["address","bldgclass"]});return r.addLayer(c).then(()=>{Q.add({order:5,ref:c,label:"Show Schools and Churches",checked:!1})}).catch(t=>console.log(t.message)),c.on("featureOver",t=>{let e="",a="";e+='<div class="widget">',"W1"==t.data.bldgclass?a="Public Elementary, Junior, or Senior High":"W2"==t.data.bldgclass?a="Parochial School, Yeshiva":"W3"==t.data.bldgclass?a="School or Academy":"M1"==t.data.bldgclass?a="Church, Synagogue, Chapel":"M2"==t.data.bldgclass?a="Mission House (non-residential)":"M3"==t.data.bldgclass?a="Parsonage, Rectory":"M4"==t.data.bldgclass?a="Convent":"M9"==t.data.bldgclass&&(a="Miscellaneous Religious Facility"),e+=`<p>Address: ${t.data.address}</p><p>DCP Building Class: ${a}</p>`,o.setContent(e),o.setLatLng(t.latLng),o.isOpen()||o.openOn(s)}),r.getLeafletLayer().addTo(s),[]}class Rt extends P{constructor(t){super(),I(this,t,Ot,null,r,{})}}function Lt(t){let e,a,n,s,r;const o=new bt({}),l=new wt({}),d=new kt({}),u=new St({}),h=new Rt({});return{c(){N(o.$$.fragment),e=p(),N(l.$$.fragment),a=p(),N(d.$$.fragment),n=p(),N(u.$$.fragment),s=p(),N(h.$$.fragment)},m(t,c){j(o,t,c),i(t,e,c),j(l,t,c),i(t,a,c),j(d,t,c),i(t,n,c),j(u,t,c),i(t,s,c),j(h,t,c),r=!0},i(t){r||(F(o.$$.fragment,t),F(l.$$.fragment,t),F(d.$$.fragment,t),F(u.$$.fragment,t),F(h.$$.fragment,t),r=!0)},o(t){Y(o.$$.fragment,t),Y(l.$$.fragment,t),Y(d.$$.fragment,t),Y(u.$$.fragment,t),Y(h.$$.fragment,t),r=!1},d(t){H(o,t),t&&c(e),H(l,t),t&&c(a),H(d,t),t&&c(n),H(u,t),t&&c(s),H(h,t)}}}function Et(t){let e,a,n=t[1]&&Lt();return{c(){e=u("div"),n&&n.c(),f(e,"id","map"),f(e,"class","svelte-16jssmr")},m(s,r){i(s,e,r),n&&n.m(e,null),t[4](e),a=!0},p(t,[a]){t[1]?n?F(n,1):(n=Lt(),n.c(),F(n,1),n.m(e,null)):n&&(D(),Y(n,1,1,()=>{n=null}),z())},i(t){a||(F(n),a=!0)},o(t){Y(n),a=!1},d(a){a&&c(e),n&&n.d(),t[4](null)}}}function xt(t,e,a){let n,s,r,o;var l,i,c;return l=gt,i={getMap:()=>r,getCartoClient:()=>s,getPopup:()=>o},w().$$.context.set(l,i),c=()=>{s=new carto.Client({apiKey:gt,username:"betanyc"}),a(1,r=L.map(n,{maxZoom:20}).setView([40.73,-74],18)),r.scrollWheelZoom.disable(),o=L.popup({closeButton:!1}),L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager/{z}/{x}/{y}{r}.png",{maxZoom:20}).addTo(r),J.set(r)},w().$$.on_mount.push(c),[n,r,s,o,function(t){k[t?"unshift":"push"](()=>{a(0,n=t)})}]}class Mt extends P{constructor(t){super(),I(this,t,xt,Et,r,{})}}function Tt(e){let a,n,s,r,o,d,h=e[1].content+"",m=e[1].source+"";return{c(){a=u("div"),s=p(),r=u("div"),o=p(),n=new _(h,s),d=new _(m,null),f(a,"class","infobox svelte-6k85pk")},m(t,c){i(t,a,c),n.m(a),l(a,s),l(a,r),e[2](r),l(a,o),d.m(a)},p(t,[e]){2&e&&h!==(h=t[1].content+"")&&n.p(h),2&e&&m!==(m=t[1].source+"")&&d.p(m)},i:t,o:t,d(t){t&&c(a),e[2](null)}}}function qt(t,e,a){let n,s;return o(t,V,t=>a(1,n=t)),t.$$.update=()=>{3&t.$$.dirty&&s&&(a(0,s.innerHTML="",s),n.charts.forEach(t=>s.appendChild(t)))},[s,n,function(t){k[t?"unshift":"push"](()=>{a(0,s=t)})}]}class At extends P{constructor(t){super(),I(this,t,qt,Tt,r,{})}}function Dt(e){let a,n,s,r,o;const d=new At({});return{c(){a=u("div"),n=u("span"),n.textContent="×",s=p(),N(d.$$.fragment),f(n,"class","close svelte-qj9d2u"),f(a,"class","modal svelte-qj9d2u")},m(t,e){i(t,a,e),l(a,n),l(a,s),j(d,a,null),r=!0,o=m(n,"click",Ft)},p:t,i(t){r||(F(d.$$.fragment,t),r=!0)},o(t){Y(d.$$.fragment,t),r=!1},d(t){t&&c(a),H(d),o()}}}function zt(t){let e,a,n,s,r,o,d;const h=new ft({}),m=new Mt({});let g=t[0]&&Dt();return{c(){e=u("main"),a=u("div"),n=u("div"),N(h.$$.fragment),s=p(),r=u("div"),N(m.$$.fragment),o=p(),g&&g.c(),f(n,"class","left svelte-qj9d2u"),f(r,"class","right svelte-qj9d2u"),f(a,"class","panel svelte-qj9d2u"),f(e,"class","svelte-qj9d2u")},m(t,c){i(t,e,c),l(e,a),l(a,n),j(h,n,null),l(a,s),l(a,r),j(m,r,null),l(e,o),g&&g.m(e,null),d=!0},p(t,[a]){t[0]?g?(g.p(t,a),F(g,1)):(g=Dt(),g.c(),F(g,1),g.m(e,null)):g&&(D(),Y(g,1,1,()=>{g=null}),z())},i(t){d||(F(h.$$.fragment,t),F(m.$$.fragment,t),F(g),d=!0)},o(t){Y(h.$$.fragment,t),Y(m.$$.fragment,t),Y(g),d=!1},d(t){t&&c(e),H(h),H(m),g&&g.d()}}}function Ft(){Z.set(!1)}function Yt(t,e,a){let n;return o(t,Z,t=>a(0,n=t)),[n]}return new class extends P{constructor(t){super(),I(this,t,Yt,zt,r,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
